# L4D2 风格 - 俯视视角 HUD 设计方案

> **平台说明**：本 HUD 设计方案专为**横屏手机端（Landscape）**上的俯视视角（Top-Down）射击游戏定制，核心理念是"极简、智能、情境驱动"，完美契合"一键多用"的需求。屏幕比例为 16:9 或 18:9。

---

## 设计理念

- **极简**：常驻按钮最少化，避免屏幕拥挤
- **智能**：根据情境动态显示交互按钮，减少误操作
- **情境驱动**：交互按钮只在需要时出现，实现"一键多用"

---

## 核心布局（四大区域）

### 区域一：左下角（移动与状态）

这是玩家"移动"和"查看"的区域。

#### [虚拟摇杆] (Virtual Joystick)
- **功能**：控制角色移动。这是左手大拇指的唯一操作区域。
- **位置**：屏幕左下角，固定位置
- **尺寸**：适配拇指操作，建议直径 80-100px

#### [玩家状态] (Player Status - 位于左上角)
- **功能**：显示玩家的**血量条**和**当前弹药**（例如 `30/300`）
- **设计**：保持小巧，不遮挡视野
- **布局**：
  - 血量条：横向显示，颜色随血量变化（绿色 → 黄色 → 红色）
  - 弹药显示：数字格式 `当前弹匣/总弹药`

#### [队友状态] (Team Status - 位于左侧边缘)
- **功能**：L4D2 的核心！垂直排列显示另外三名队友的**头像/名字**和**血量条**
- **设计**：
  - 当队友倒地或被特感控制时，其头像应**高亮闪烁**，提供关键战场信息
  - 队友头像下方显示血量条
  - 队友名字显示在头像旁边或下方
- **状态指示**：
  - 正常：绿色边框
  - 受伤：黄色边框
  - 倒地：红色边框 + 闪烁
  - 被特感控制：紫色边框 + 闪烁

---

### 区域二：右下角（核心战斗簇）

这是玩家"战斗"的主区域，所有高频动作都集中在这里，便于右手大拇指操作。

#### [射击] (Shoot Button)
- **功能**：开火。这是该区域最大、最核心的按钮。
- **位置**：右下角中央，最大按钮
- **尺寸**：建议直径 80-100px
- **智能设计**：
  - 在俯视视角下，应配合**自动瞄准**或**扇形辅助瞄准**逻辑
  - 玩家只决定"何时"开火，系统自动处理瞄准
- **情境切换**：
  - 选中医疗物品时，临时变为【对自己使用】按钮
  - 选中投掷物时，临时变为【投掷】按钮

#### [推] (Shove / Melee)
- **功能**：L4D2 的灵魂！近距离推开僵尸或进行近战攻击。
- **位置**：放在"射击"按钮旁边（例如正上方）
- **尺寸**：建议直径 60-70px
- **设计**：玩家可以快速用大拇指"滚"过去按，实现"射击-推-射击"的流畅操作
- **冷却提示**：推击有冷却时间，按钮上显示冷却进度环

#### [换弹] (Reload)
- **功能**：战术换弹。
- **位置**：放在"射击"按钮的另一侧（例如右侧）
- **尺寸**：建议直径 60-70px
- **智能设计**：
  - 当弹匣打空时，应**自动换弹**
  - 这个按钮仅供玩家"提前换弹"使用
- **显示**：换弹时显示进度条或倒计时

---

### 区域三：右上角（战略物品）

这是"模式切换"的区域，用于使用医疗包和投掷物，完美实现"一键多用"。

#### [武器切换] (Weapon Swap)
- **功能**：切换主/副武器（例如 步枪 / 手枪）
- **位置**：右上角顶部
- **设计**：一个简单的图标按钮，显示当前武器和切换后的武器预览
- **尺寸**：建议 50x50px

#### [医疗物品槽] (Heal Item Slot)
- **功能**：显示你携带的医疗包/药丸/肾上腺素
- **位置**：右上角，武器切换按钮下方
- **显示**：
  - 图标：显示当前携带的医疗物品类型
  - 数量：显示可用数量（如 `医疗包 x2`）
- **智能交互（对自己打包）**：
  1. 玩家**点击**此槽位（选中医疗包）
  2. 右下角的【射击】按钮临时变为【对自己使用】按钮
  3. 玩家点击【对自己使用】完成打包
  4. 使用后自动恢复为【射击】按钮

#### [投掷物品槽] (Throwable Slot)
- **功能**：显示你携带的土制炸弹/燃烧瓶/胆汁
- **位置**：右上角，医疗物品槽下方
- **显示**：
  - 图标：显示当前携带的投掷物类型
  - 数量：显示可用数量（如 `燃烧瓶 x1`）
- **智能交互（投掷）**：
  1. 玩家**点击**此槽位（选中燃烧瓶）
  2. 右下角的【射击】按钮临时变为【投掷】按钮
  3. （可选）游戏进入慢动作，屏幕上出现抛物线
  4. 玩家拖动瞄准，松手投掷
  5. 投掷后自动恢复为【射击】按钮

---

### 区域四：中央右侧（情境交互区）

这是整个 HUD 设计的精髓，它解决了救援、捡枪、捡配件、帮队友打包的所有需求，而**不需要在屏幕上增加任何常驻按钮**。

#### [情境交互按钮] (Smart Context Button)

**机制**：你的角色周围有一个"交互检测圈"（玩家不可见，半径约 2-3 米）。当有可交互的物体进入这个圈时，一个**唯一的"交互按钮"**会自动浮现。

**按钮位置**：建议浮现在屏幕**中央右侧**，或者直接替换掉不常用的【换弹】按钮位置。

**按钮尺寸**：建议直径 70-80px，足够醒目但不遮挡视野。

---

#### "情境交互"如何工作

##### 1. 救援 (Rescue)
- **情境**：你靠近一个倒地的队友
- **按钮显示**：【救起 [队友名字]】
- **交互**：点击按钮开始救援，显示进度条（1.5 秒）
- **视觉反馈**：被救队友头像高亮，进度条显示在按钮上或屏幕中央

##### 2. 拾取 (Pick up)
- **情境**：你走到一把地上的新武器或配件上
- **按钮显示**：【拾取 AK47】或【拾取 红外仪】
- **交互**：点击按钮完成拾取
- **智能处理**：
  - 拾取武器时，自动替换当前武器或放入背包
  - 拾取配件时，自动装备或提示装备位置

##### 3. 帮队友打包 (Heal Ally)
- **情境**：你**已选中**【医疗物品槽】（见区域三），并且靠近一名受伤的队友
- **按钮显示**：【治疗 [队友名字]】
- **交互**：点击按钮开始治疗，显示进度条
- **视觉反馈**：队友血量条实时更新

##### 4. 常规交互 (Interact)
- **情境**：你靠近一个需要开启的机关门或安全屋的门
- **按钮显示**：【开门】或【启动机关】
- **交互**：点击按钮执行交互
- **特殊交互**：
  - 需要持续按住：显示进度条
  - 需要多次交互：显示交互次数（如 `按 3 次`）

##### 5. 其他情境交互示例
- **拾取弹药**：【拾取 5.56mm 弹药 x30】
- **使用医疗包**（对自己）：选中医疗物品槽后，按钮显示【对自己使用】
- **投掷物品**（对目标）：选中投掷物槽后，按钮显示【投掷到 [目标位置]】
- **推车/推门**：【推动 [物体名称]】
- **激活机关**：【激活 [机关名称]】

---

## 智能化的核心：情境交互系统

### 交互优先级

当多个可交互对象同时进入检测圈时，按以下优先级显示：

1. **救援队友**（最高优先级）
2. **治疗队友**（选中医疗物品时）
3. **拾取武器/配件**
4. **常规交互**（开门、激活机关等）
5. **拾取弹药/物品**

### 交互检测圈

- **半径**：约 2-3 米（游戏单位）
- **检测频率**：每帧检测一次
- **视觉提示**（可选）：在调试模式下显示检测圈范围

### 按钮动画

- **出现**：从透明淡入，伴随轻微缩放动画（0.8 → 1.0）
- **消失**：淡出动画，避免突兀
- **高亮**：重要交互（如救援）时，按钮可轻微脉冲闪烁

---

## 横屏手机端优化

### 按钮尺寸适配

- **虚拟摇杆**：80-100px 直径
- **射击按钮**：80-100px 直径（最大）
- **推/换弹按钮**：60-70px 直径
- **物品槽按钮**：50-60px 尺寸
- **情境交互按钮**：70-80px 直径

### 拇指操作区域

- **左侧**：虚拟摇杆区域，左手拇指自然放置位置
- **右侧**：战斗按钮区域，右手拇指自然放置位置
- **避免误触**：按钮之间保持 15-20px 间距

### 屏幕适配

- **16:9 屏幕**：标准布局
- **18:9 / 19:9 屏幕**：上下留黑边或调整 UI 缩放
- **刘海屏适配**：确保关键按钮不位于刘海区域

---

## 视觉风格与美学设计 (Aesthetic and Visual Design)

为了让俯视视角的游戏 HUD 拥有《求生之路》的末世紧张感和高科技军用风格，我们采用以下设计原则：

### A. 整体风格：高对比度、军用 GRUNGE

#### 主题
- **紧急行动中的战术显示屏** (Tactical Display)
- 模拟军事行动中的实时监控界面，强调紧迫感和专业性

#### 质感
- 界面元素应带有轻微的**磨损、扫描线或毛刺效果**
- 模拟信号干扰和旧式 CRT 显示屏的数字感
- 增强末世的代入感和沉浸感

#### 边框设计
- 所有框体（如状态栏、物品槽）使用**坚硬的直线和锐角**
- 避免圆润的边角，体现军用设备的严谨感
- 边框线条粗细：2-3px

---

### B. 核心配色方案

采用"高对比度"和"紧急警告色"作为主要色彩。

| 区域/状态 | 主色调 (HEX) | 辅助色/边框 | 效果描述 |
| --- | --- | --- | --- |
| **背景/默认** | 深黑 (#0A0A0A) | 透明度 70% | 确保所有按钮不会严重遮挡地图 |
| **信息显示** | 霓虹绿 (#39FF14) | 纯白 (#FFFFFF) | 用于弹药计数、队友满血状态、摇杆默认颜色。代表"安全/正常" |
| **警告状态** | 琥珀黄/橙 (#FFB700) | 闪烁效果 | 用于队友血量低于 50%、弹药即将耗尽、情境交互按钮浮现 |
| **危险/紧急** | 鲜红 (#FF073A) | 快速闪烁 | 用于玩家自身低血量（低于 25%）、队友倒地、特感控制提示 |

#### 配色使用示例

- **血量条**：
  - 100-50%：霓虹绿 (#39FF14)
  - 50-25%：琥珀黄 (#FFB700)
  - 25-0%：鲜红 (#FF073A)，快速闪烁

- **弹药显示**：
  - 充足：霓虹绿 (#39FF14)
  - 即将耗尽（< 30%）：琥珀黄 (#FFB700)
  - 弹匣打空：鲜红 (#FF073A)

- **队友状态**：
  - 正常：霓虹绿边框 (#39FF14)
  - 受伤：琥珀黄边框 (#FFB700)
  - 倒地：鲜红边框 (#FF073A) + 快速闪烁
  - 被特感控制：鲜红边框 (#FF073A) + 快速闪烁

---

### C. 字体与图标设计

#### 字体 (Font)
- **采用数字化、几何化的无衬线字体**（如 Digital-7 或类似风格）
- 模仿老式 LED 或 LCD 显示屏
- 字体大小：
  - 弹药计数：24-28px
  - 队友名字：18-20px
  - 情境交互按钮文字：22-24px
  - 血量条数值：16-18px

#### 图标 (Icons)
- **单色线条描边风格**，简洁、清晰
- 配合颜色变化来显示状态
- 图标尺寸：
  - 按钮图标：40-50px
  - 物品槽图标：32-40px
  - 队友头像：48-56px

#### 图标示例
- **射击按钮**：瞄准镜或十字准星图标
- **推击按钮**：手掌或拳头图标
- **换弹按钮**：弹匣或子弹图标
- **医疗包**：十字医疗图标
- **投掷物**：手雷或燃烧瓶图标

---

### D. 动态效果与反馈

#### 战斗簇反馈

**射击按钮**：
- 点击时，按钮应有一个短暂的**"按下-抬起"的霓虹光效**
- 瞬间变亮/闪烁绿色 (#39FF14)
- 持续时间：100-150ms
- 给予玩家爽快的反馈

**推击按钮**：
- 点击时，按钮闪烁琥珀黄 (#FFB700)
- 伴随轻微的震动反馈（如果设备支持）
- 冷却期间，按钮显示进度环，颜色从琥珀黄渐变到霓虹绿

**换弹按钮**：
- 换弹时，按钮显示进度条填充动画
- 进度条颜色：琥珀黄 (#FFB700)
- 完成后，按钮短暂闪烁霓虹绿 (#39FF14)

#### 情境交互反馈

**情境交互按钮浮现**：
- 从半透明（alpha: 0.3）到实体（alpha: 1.0）的平滑过渡动画
- 持续时间：200-300ms
- 伴随一个低沉的"哔"声，吸引玩家注意力
- 按钮轻微缩放动画（0.9 → 1.0），增强视觉吸引力

**重要交互（如救援）**：
- 按钮可轻微脉冲闪烁（亮度 80% → 100% → 80%）
- 闪烁频率：每 0.5 秒一次
- 边框颜色：鲜红 (#FF073A)

#### 队友状态反馈

**血量条变化**：
- 血量条应具有**平滑的过渡动画**（而非瞬间变化）
- 过渡时间：300-500ms
- 在治疗或受伤时，血条周围会有短暂的白色/绿色脉冲效果
- 脉冲持续时间：200-300ms

**队友头像闪烁**：
- 倒地或被控制时，头像边框快速闪烁鲜红 (#FF073A)
- 闪烁频率：每 0.3 秒一次
- 头像本身轻微缩放（1.0 → 1.1 → 1.0），增强警示效果

#### 物品槽反馈

**选中医疗物品槽**：
- 槽位边框变为霓虹绿 (#39FF14)
- 射击按钮图标切换为医疗图标
- 按钮颜色变为霓虹绿，伴随淡入动画

**选中投掷物槽**：
- 槽位边框变为琥珀黄 (#FFB700)
- 射击按钮图标切换为投掷图标
- 按钮颜色变为琥珀黄，伴随淡入动画
- （可选）进入慢动作模式，显示抛物线轨迹

---

### E. 视觉特效细节

#### 扫描线效果（可选）
- 在状态栏和物品槽上添加轻微的扫描线纹理
- 模拟 CRT 显示屏效果
- 扫描线透明度：10-15%
- 扫描线移动速度：缓慢（每 2-3 秒一次）

#### 信号干扰效果（可选）
- 在紧急状态下（低血量、队友倒地），添加轻微的信号干扰效果
- 干扰强度：5-10%
- 持续时间：短暂（1-2 秒）

#### 边框发光效果
- 重要按钮（射击、情境交互）在激活时，边框会有轻微的发光效果
- 发光颜色：霓虹绿 (#39FF14) 或琥珀黄 (#FFB700)
- 发光强度：20-30%
- 使用 CSS `box-shadow` 或类似效果实现

---

## HUD 优势总结

### 极其干净
- 常驻按钮只有：摇杆 + 射击 + 推 + 换弹 + 物品槽
- 总按钮数量：6-7 个（不含情境交互按钮）

### 高度智能
- "救援"、"拾取"、"治疗"等几十种操作，全部被整合进一个"只在需要时才出现"的【情境交互按钮】中
- 减少屏幕拥挤，降低误操作率

### 一键多用
- "打包"和"投掷"通过切换【射击】按钮的功能来实现，无需额外按键
- 选中物品槽后，射击按钮自动切换功能，直观易懂

### 完美适配
- 完全符合俯视视角小游戏的快节奏
- 充分利用手机屏幕的限制，避免按钮过多导致操作困难

---

## 程序实现要点

### 状态管理
- 使用状态机管理交互模式（正常射击 / 医疗模式 / 投掷模式）
- 情境交互按钮的显示/隐藏逻辑

### 交互检测
- 使用物理检测圈（Physics Overlap）检测可交互对象
- 按优先级排序可交互对象列表

### UI 组件
- 虚拟摇杆组件（可复用）
- 情境交互按钮组件（动态显示/隐藏）
- 进度条组件（救援、治疗、换弹等）

### 性能优化
- 交互检测圈使用对象池，避免频繁创建/销毁
- 按钮动画使用 CSS 动画或 GPU 加速

---

## 美术资源需求

### UI 图标
- 虚拟摇杆背景和摇杆球
- 射击按钮（正常状态 / 医疗状态 / 投掷状态）
- 推击按钮
- 换弹按钮
- 武器切换图标
- 医疗物品图标（医疗包 / 药丸 / 肾上腺素）
- 投掷物图标（炸弹 / 燃烧瓶 / 胆汁）
- 情境交互按钮背景

### 动画
- 按钮按下动画
- 按钮切换动画（射击 → 医疗 → 投掷）
- 情境交互按钮出现/消失动画
- 进度条填充动画

### 特效
- 队友头像闪烁特效（倒地/被控制时）
- 血量条颜色渐变
- 按钮冷却进度环

---

## 技术实现映射（2025-11-10）

- **HUD 组件**：`src/components/GameHud.tsx` 拆分为生命护甲、队友列表、战斗簇、战略物品、情境交互等子模块，采用 `GameHud.css` 完成军用高对比样式。
- **状态管理**：新增 `useHudStore`（`src/state/hudStore.ts`）同步战斗冷却、队友状态、情境交互提示，并与 `usePlayerStore` 的库存信息整合。
- **Phaser 联动**：`GameScene` 通过自定义 `hud:action` 事件监听触发射击/推击/换弹，并在每帧调用 `syncHudState()` 反哺 HUD（弹药、冷却、可用性等）。推击逻辑在场景内对敌群施加推开速度，带来即时反馈。
- **交互事件流**：React HUD 按钮触发 `window.dispatchEvent('hud:action')`，Phaser 响应后更新 `useHudStore`，再由 HUD 组件自动刷新界面，实现“按钮 → 事件 → 游戏行为 → 状态回写”的闭环。
- **占位数据**：`useHudStore` 目前内置样例队友状态，后续可由联网或 AI 系统实时写入；库存字段来自 `usePlayerStore`，可在拾取/消耗物品时更新。

---

> **待办**：根据实际开发进度，逐步实现各区域功能，优先实现核心战斗簇（射击、推、换弹）和情境交互系统。

